#  –î–µ—Ç–µ–∫—Ü–∏—è —Å–∏–≥–∞—Ä–µ—Ç üö¨

## –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ –Ω–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π:
1.  **Backend (API):** –ù–∞–ø–∏—Å–∞–Ω –Ω–∞ FastAPI. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å.
2.  **Frontend (UI):** –ù–∞–ø–∏—Å–∞–Ω –Ω–∞ Streamlit. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —É–¥–æ–±–Ω–æ–º –≤–∏–¥–µ.
–î–ª—è –∑–∞–ø—É—Å–∫–∞:

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install -r requirements.txt
```
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ API
```python
python api.py
```

- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∞–π—Ç–∏–∫ –Ω–∞ Streamlit
```bash
streamlit run app.py
```



## –î–∞—Ç–∞—Å–µ—Ç
[–î–∞—Ç–∞—Å–µ—Ç –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç—É—Ç](https://universe.roboflow.com/visionwork/smoking_person)

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
–í –¥–∞—Ç–∞—Å–µ—Ç–µ –±—ã–ª–∏ –¥—Ä—É–≥–∏–µ –∫–ª–∞—Å—Å—ã –¥—Ä—É–≥–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –ø–æ–º–∏–º–æ —Å–∏–≥–∞—Ä–µ—Ç. –£–¥–∞–ª–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ –Ω–∏—Ö –∏–∑ labels.
–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–º–µ–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

      –° —Å–∏–≥–∞—Ä–µ—Ç–∞–º–∏: 5088
      –ë–µ–∑ —Å–∏–≥–∞—Ä–µ—Ç: 3037
      –í—Å–µ–≥–æ: 8125



# –ó–∞–¥–∞—á–∞
–î–ª—è –ø–æ–∏—Å–∫–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è —Å–∏–≥–∞—Ä–µ—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–¥–µ–ª—å—é –±—É–¥–µ—Ç —Ä–µ—à–∞—Ç—å—Å—è –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è - –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
2. –†–µ–≥—Ä–µ—Å—Å–∏—è - –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –±–æ–∫—Å–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è

## Faster RCNN (Region Based Convolutional Neural Networks)

–î–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –∫–∞–∫ –±–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–ª–µ–µ –±—É–¥—É—Ç –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—Ç—å—Å—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏. Faster RCNN –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è, –∫–∞–∫ —ç—Ç–æ —É–∂–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–Ω—è—Ç—å –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, –Ω–∞ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö. 
<img width="850" height="284" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/cd9606e8-5293-472e-b5df-4a03c5df4ff6" />

–í –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –º–æ–¥–µ–ª–∏, –µ—Å–ª–∏ –∏–¥—Ç–∏ –ø—Ä—è–º –ø–æ –≤–µ—Ä—Ö–∞–º, –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å 3 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–ª–æ—è:
1. Backbone - –≥–ª–∞–∑–∞ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ù–µ–∫–æ—Ç–æ—Ä–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Å—Ö–µ–º–µ –≤—ã—à–µ, - VGG, –≤ –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ - ResNet50. –ó–∞–¥–∞—á–∞ –¥–∞–Ω–Ω–æ–≥–æ —Å–ª–æ—è —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—Ä–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏, –≤—ã–¥–µ–ª–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã.
2. RPN (Region Proposal Network) - —Å–æ–∑–¥–∞–Ω–µ–∏ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ "–∑–æ–Ω –∏–Ω—Ç–µ—Ä–µ—Å–∞" –Ω–∞ –∫–∞—Ä—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Anchor generator).
3. ROI Pooling - –ø—Ä–æ–≥–æ–Ω, —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–º –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö "–∑–æ–Ω –∏–Ω—Ç–µ—Ä–µ—Å–∞" (—è–∫–æ—Ä–µ–π).
   1. ROI head - –ø—Ä–æ–≥–æ–Ω —Å–≤–µ—Ä—Ç–æ–∫ –∑–æ–Ω –∏–Ω—Ç–µ—Ä–µ—Å–∞ —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—É—é —Å–µ—Ç—å, –Ω–∞ –≤—ã—Ö–æ–¥–µ –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–ª–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∫–∞—Ü–∏–∏ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
   2. –î–µ–∫–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–∫—Å–æ–≤ - –ø—Ä–∏–≤–æ–¥–∏–º –∑–æ–Ω—ã –∏–Ω—Ç–µ—Ä–µ—Å–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   3. Post-processing (NMS) - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ score

## YOLOv8n
1. –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –º–æ–¥–µ–ª—å—é YOLOv8n –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å–∏–≥–∞—Ä–µ—Ç. –í—ã–±—Ä–∞–ª–∏ –≤–µ—Ä—Å–∏—é "nano", —Ç.–∫. –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –∏–º–µ—é—â–∏—Ö—Å—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –∑–∞ –ø—Ä–∏–µ–º–ª–µ–º–æ–µ –∫–æ–ª-–≤–æ –≤—Ä–µ–º–µ–Ω–∏.

2. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –ø–æ–¥–∞–≤–∞–µ–º–æ–≥–æ –≤ –º–æ–¥–µ–ª—å. –°–∏–≥–∞—Ä–µ—Ç—ã - –¥–æ–≤–æ–ª—å–Ω–æ –º–∞–ª–µ–Ω—å–∫–∏–π –æ–±—ä–µ–∫—Ç. –•–æ—Ç—å –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∫—É—Ä—Å–∞—Ö —Å–∏–≥–∞—Ä–µ—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å "–±–æ–ª—å—à–æ–π", —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–∏—Ç—É–∞—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–∞—è.

**–ö—Ä–∞—Ç–∫–æ –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ YOLOv8n:**
1. Backbone
   - –í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã - —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è CSPDarknet. –û–Ω–∞ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ –∫–∞–∫ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã, —Ç–∞–∫ –∏ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
2. Neck
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–µ—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ø—É—Ç–µ–π (PANet), —É–ª—É—á—à–µ–Ω–Ω—É—é –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±–º–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. 
3. Head
   - –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤. –í —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏ –Ω–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–∫–æ—Ä–µ–π (Anchor-free)
   - –í YOLOv8 –≤–µ—Ç–∫–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞ (—á—Ç–æ —ç—Ç–æ?) –∏ –≤–µ—Ç–∫–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (–≥–¥–µ —ç—Ç–æ?) —Ä–∞–∑–¥–µ–ª–µ–Ω—ã. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏.

# –†–µ—à–µ–Ω–∏–µ

## –†–µ—à–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é FRCNN
–í —Ü–µ–ª—è—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±—ã–ª–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å FasterRCNN —Å –±—ç–∫–±–æ–Ω–æ–º –∏–∑ ResNet50
```
weights = FasterRCNN_ResNet50_FPN_Weights.DEFAULT
model = fasterrcnn_resnet50_fpn(weights=weights)
```
–ú—ã –∑–∞–º–æ—Ä–æ–∑–∏–ª–∏ –≤—Å–µ —Å–ª–æ–∏ ResNet50 (–±—ç–∫–±–æ–Ω–∞), –∫—Ä–æ–º–µ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö, —á—Ç–æ–±—ã –¥–æ–æ–±—É—á–∏—Ç—å –∏—Ö –Ω–∞ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
```
for p in model.backbone.parameters():
    p.requires_grad = False # –º–æ—Ä–æ–∂—É –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã / –æ—Ç–∫–ª—é—á–∞—é –æ–±—É—á–µ–Ω–∏–µ
for p in model.backbone.fpn.parameters():
    p.requires_grad = True   # FPN –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ –æ–±—É—á–∞—Ç—å!

for p in model.backbone.body.layer3.parameters():
    p.requires_grad = True
for p in model.backbone.body.layer4.parameters():
    p.requires_grad = True
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ MAP50

$$
\[
\text{mAP}_{50}
= \frac{1}{N_{\text{classes}}}
  \sum_{c=1}^{N_{\text{classes}}}
  \left(
    \int_{0}^{1} \text{Precision}_{c}\big(\text{Recall}_{c}\big) \, d(\text{Recall}_{c})
  \right)
\]
$$

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã FRCNN

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –±–æ–ª—å—à–µ 10 —á–∞—Å–æ–≤
```
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 1/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:22:32<00:00,  9.90s/it, loss=tensor(0.0693, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 1/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:33<00:00,  2.43s/it, map=0.613]
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –º–æ–¥–µ–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º MAP: 0.6132366061210632
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 2/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:16:03<00:00,  9.13s/it, loss=tensor(0.0335, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 2/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:17<00:00,  2.19s/it, map=0.685]
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –º–æ–¥–µ–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º MAP: 0.6852678060531616
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 3/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:21:28<00:00,  9.78s/it, loss=tensor(0.0825, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 3/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:19<00:00,  2.21s/it, map=0.753]
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –º–æ–¥–µ–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º MAP: 0.7534715533256531
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 4/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:11:22<00:00,  8.56s/it, loss=tensor(0.1048, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 4/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:16<00:00,  2.16s/it, map=0.718]
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 5/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:09:54<00:00,  8.39s/it, loss=tensor(0.0340, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 5/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:00<00:00,  1.91s/it, map=0.735]
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 6/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:05:00<00:00,  7.80s/it, loss=tensor(0.0551, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 6/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:03<00:00,  1.95s/it, map=0.673]
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 7/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:04:39<00:00,  7.76s/it, loss=tensor(0.0506, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 7/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [02:12<00:00,  2.11s/it, map=0.717]
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 8/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:08:19<00:00,  8.20s/it, loss=tensor(0.0542, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 8/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [01:57<00:00,  1.87s/it, map=0.71] 
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 9/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:05:50<00:00,  7.90s/it, loss=tensor(0.0368, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 9/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [01:57<00:00,  1.87s/it, map=0.717]
–≠–ø–æ—Ö–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è 10/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 500/500 [1:03:57<00:00,  7.68s/it, loss=tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)]
–≠–ø–æ—Ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è 10/10: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 63/63 [01:59<00:00,  1.90s/it, map=0.712]
```
–ò —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –µ–µ –æ–±—É—á–µ–Ω–∏–µ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å –Ω–∞ 3 —ç–ø–æ—Ö–µ. –î–∞–ª—å—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ MAP50 —É–∂–µ –Ω–µ —É–ª—É—á—à–∞–ª–∏—Å—å.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç –º–æ–¥–µ–ª–∏ Faster RCNN:

<img width="288" height="482" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/d4d95c9d-6593-4058-948c-9d1917d6843a" />
<img width="640" height="420" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/aac3f24c-975a-4fe4-a836-7faff385d48b" />
<img width="327" height="482" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/1a87601f-6d37-43f1-a7bb-f2ee440b0c46" />
<img width="597" height="482" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/e3dc7337-91ac-460b-8807-7f766ffab3b0" />
<img width="341" height="482" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/b56daceb-5671-417e-89ea-e94c0d4cdf8c" />
<img width="640" height="368" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" src="https://github.com/user-attachments/assets/8b49c718-ab16-403c-a2e3-ea3877a48419" />

–ú–æ–¥–µ–ª—å –æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ –±–µ–∑ –∫–æ—Å—è–∫–æ–≤. –ù–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç MAP –ø–æ–ª—É—á–∏–ª—Å—è: 63,1 %

## –†–µ—à–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é YOLOv8n
–í—ã–±—Ä–∞–ª–∏ –≤–µ—Ä—Å–∏—é "nano", —Ç.–∫. –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –∏–º–µ—é—â–∏—Ö—Å—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –∑–∞ –ø—Ä–∏–µ–º–ª–µ–º–æ–µ –∫–æ–ª-–≤–æ –≤—Ä–µ–º–µ–Ω–∏
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –ø–æ–¥–∞–≤–∞–µ–º–æ–≥–æ –≤ –º–æ–¥–µ–ª—å. –°–∏–≥–∞—Ä–µ—Ç—ã - –¥–æ–≤–æ–ª—å–Ω–æ –º–∞–ª–µ–Ω—å–∫–∏–π –æ–±—ä–µ–∫—Ç. –•–æ—Ç—å –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ä–∞–∫—É—Ä—Å–∞—Ö —Å–∏–≥–∞—Ä–µ—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å "–±–æ–ª—å—à–æ–π". –û–¥–Ω–∞–∫–æ —á–∞—â–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å–∏—Ç—É–∞—Ü–∏—é –æ–±—Ä–∞—Ç–Ω–∞—è.
–¢–∞–∫ –∫–∞–∫ —É–≤–µ–ª–∏—á–∏–ª–∏ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ç–æ –∏ —É–≤–µ–ª–∏—á–∏–º –∫–æ–ª-–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.

```
model = YOLO("yolov8n.pt")

model.train(
    data="/content/Dataset/data.yaml",
    epochs=30,
    imgsz=480,
    batch=16,
    workers=4,
    device=0,       # GPU, "cpu" –µ—Å–ª–∏ –Ω–µ—Ç CUDA
    project="runs/cigarette",
    name="yolov8n_480",
    augment=True,   # –≤–∫–ª—é—á–∞–µ–º –±–∞–∑–æ–≤—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
    mosaic=False,   # –æ—Ç–∫–ª—é—á–∞–µ–º –º–æ–∑–∞–∏–∫–∏
    mixup=False,     # –æ—Ç–∫–ª—é—á–∞–µ–º –º–∏–∫—Å–∞–ø
    cache=True
)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã YOLO
–ú–æ–¥–µ–ª—å YOLO –æ–±—É—á–∏–ª–∞—Å—å –Ω–∞ –±–æ–ª—å—à–µ–º —á–∏—Å–ª–µ —ç–ø–æ—Ö –∏ –æ–±—É—á–∏–ª–∞—Å—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ FRCNN

![val_batch0_labels](https://github.com/user-attachments/assets/f1962c2c-0eea-42bc-9f56-e48a444d46f3)
![val_batch2_labels](https://github.com/user-attachments/assets/b9de8ce0-a427-4836-be59-a5c6c9f4904e)
![val_batch1_pred](https://github.com/user-attachments/assets/fb4ae4a7-bbce-45e0-b92f-10a031fcd358)
![val_batch1_labels](https://github.com/user-attachments/assets/c3df46a5-ce51-4780-9ba7-993e18d95398)
![val_batch0_pred](https://github.com/user-attachments/assets/b71e19ca-1831-44d4-bc4f-20dbfa092c29)


## –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | –ö–æ–ª-–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (M) | –ö–æ–ª-–≤–æ —ç–ø–æ—Ö | –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (px) | mAP50 (val) |
| :--- | :---: | :---: | :---: | :---: |
| **Faster RCNN** | 41.1 | 10 | 400-800 (–≥—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –≤—Ö–æ–¥–µ) | 0.753 |
| **YOLOv8n**| 3.01 | 20 | 320 | 0.8128 |
| **YOLOv8n** | 3.01 | 30 | 480 | 0.8445 |

# –í—ã–≤–æ–¥—ã

–ú–æ–¥–µ–ª—å YOLOv8n, –æ–±—É—á–µ–Ω–Ω–∞—è—á –Ω–∞ 30 —ç–ø–æ—Ö–∞, –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ MAP50, –ø–æ—ç—Ç–æ–º—É –≤ –∏—Ç–æ–≥–æ–≤–æ–º –ø—Ä–æ–¥–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ.
